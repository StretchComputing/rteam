<!DOCTYPE html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>rTeam - Admin</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Place favicon.ico and apple-touch-icon(s) in the root directory -->

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <!--[if lt IE 8]>
    <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
  <![endif]-->

  <h1>rTeam Admin!</h1>
  <form id="createPerson">
    <input type="file"><br>
    <input type="hidden" id="base64image">
    <img src="" height="200" alt="Image preview..."><br>
    <button type="submit">Create Person</button>
  </form>

<script src="//code.jquery.com/jquery-2.1.0.min.js"></script>
<script>
(function () {
  'use strict';

  var createPerson = function (event) {
        event.preventDefault();
        if (!$('#base64image').val()) {
          alert('Please select an image');
          return;
        }

        $.ajax({
          type: 'POST',
          url: '/persons',
          data: {
            name: 'rTeam Member',
            photoPath: $('#base64image').val()
          },
          success: function (data) {
            console.log(data);
          },
          error: function (jqXHR, status) {
            console.error(jqXHR, status);
          }
        });
      },

      previewFile = function () {
        var $preview = $('img'),
            file = $('#createPerson input[type=file]')[0].files[0],
            // file    = $('input[type=file]')[0].files[0],
            reader  = new FileReader();

        reader.onloadend = function () {
          $preview.prop('src', reader.result);
          $('#base64image').val(reader.result);
        };

        if (file) {
          reader.readAsDataURL(file);
        } else {
          $preview.prop('src', '');
        }
      };

  $('#createPerson').on('submit', createPerson);
  $('#createPerson input[type=file]').on('change', previewFile);
}());
</script>
</body>
</html>